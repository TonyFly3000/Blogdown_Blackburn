data=ramen_ratings_02%>%mutate(country=fct_lump(country,5))
ggplot(data, aes(x = country, fill = stars_level))+
geom_bar(position="fill", colour="black")+
scale_fill_manual(values=c("red", "orange", "yellow", "darkseagreen1", "forestgreen")) +
theme_classic(base_size = 9)+
labs(title='Bar chart for continents due to stars ranges',
subtitle='Cumulated', y="Indicator", fill="User assessment ranges")
data=ramen_ratings_02%>%mutate(country=fct_lump(country,5))
ggplot(data, aes(x = country, fill = factor(stars_level)))+
geom_bar(position="fill", colour="black")+
scale_fill_manual(values=c("red", "orange", "yellow", "darkseagreen1", "forestgreen")) +
theme_classic(base_size = 9)+
labs(title='Bar chart for continents due to stars ranges',
subtitle='Cumulated', y="Indicator", fill="User assessment ranges")
data=ramen_ratings_02%>%mutate(country=fct_lump(country,6))
ggplot(data, aes(x = country, fill = factor(stars_level)))+
geom_bar(position="fill", colour="black")+
scale_fill_manual(values=c("red", "orange", "yellow", "darkseagreen1", "forestgreen")) +
theme_classic(base_size = 9)+
labs(title='Bar chart for continents due to stars ranges',
subtitle='Cumulated', y="Indicator", fill="User assessment ranges")
data=ramen_ratings_02%>%mutate(country=fct_lump(country,6))
ggplot(data, aes(x = country, fill = factor(stars_level)))+
geom_bar(position="fill", colour="black")+
#scale_fill_manual(values=c("red", "orange", "yellow", "darkseagreen1", "forestgreen")) +
theme_classic(base_size = 9)+
labs(title='Bar chart for continents due to stars ranges',
subtitle='Cumulated', y="Indicator", fill="User assessment ranges")
data=ramen_ratings_02%>%mutate(country=fct_lump(country,8))
ggplot(data, aes(x = country, fill = factor(stars_level)))+
geom_bar(position="fill", colour="black")+
theme_classic(base_size = 9)+
labs(title='Bar chart for country due to stars ranges',
subtitle='Cumulated', y="Indicator", fill="User assessment ranges")
ramen_ratings %>%mutate(country=fct_lump(country,10))%>%
count(country, sort = TRUE)%>%mutate(percent = n / sum(n))
ramen_ratings %>%mutate(country=fct_lump(country,8))%>%
count(country, sort = TRUE)%>%mutate(percent = n / sum(n))
ramen_ratings%>%arrange(desc(stars))
ramen_ratings_02=ramen_ratings%>%filter(is.na(stars)==FALSE)%>%
mutate(stars_level=round(stars),stars_target=if_else(stars>=4,1,0))
ramen_ratings_02 %>%
count(stars_target, sort = TRUE)%>%mutate(percent = n / sum(n))
ramen_ratings_02=ramen_ratings%>%filter(is.na(stars)==FALSE)%>%
mutate(stars_level=round(stars),stars_target=if_else(stars>=4,1,0))%>%select(-review_number)
# input data
library(readr)
# clean data
library(tidyverse)
# model
library(rpart)
library(rpart.plot)
tree = rpart(stars_target ~brand+variety+style+country , data=ramen_ratings_02)
tree = rpart(stars_target ~brand+variety+style+country , data=ramen_ratings_02,method = 'class')
rpart.plot(tree)
tree = rpart(stars_target ~ brand + variety + style + country , data=ramen_ratings_02,method = 'class')
rpart.plot(tree)
ramen_ratings_02=ramen_ratings%>%filter(is.na(stars)==FALSE)%>%
mutate(stars_level=factor(round(stars)),stars_target=factor(if_else(stars>=4,1,0)))%>%select(-review_number)
data=ramen_ratings_02%>%mutate(country=fct_lump(country,8))
ggplot(data, aes(x = country, fill = stars_level))+
geom_bar(position="fill", colour="black")+
theme_classic(base_size = 9)+
labs(title='Bar chart for country due to stars ranges',
subtitle='Cumulated', y="Indicator", fill="User assessment ranges")
tree = rpart(stars_target ~ brand + variety + style + country , data=ramen_ratings_02,method = 'class')
rpart.plot(tree)
glimpse(ramen_ratings_02)
tree = rpart(stars_target ~ country, data=ramen_ratings_02,method = 'class')
rpart.plot(tree)
tree = rpart(stars_target ~ country+brand, data=ramen_ratings_02,method = 'class')
rpart.plot(tree)
tree = rpart(stars_target ~ country+brand+variety, data=ramen_ratings_02,method = 'class')
rpart.plot(tree)
tree = rpart(stars_target ~ country+brand+style, data=ramen_ratings_02,method = 'class')
rpart.plot(tree)
tree = rpart(stars_target ~ country+brand+style, data=ramen_ratings_02,method = 'class')
rpart.plot(tree)
prp(tree)
tree = rpart(stars_target ~ country+brand+style, data=ramen_ratings_02,method = 'class')
rpart.plot(tree)
prp(tree)
tree
set.seed(101) # Set Seed so that same sample can be reproduced in future also
# Now Selecting 75% of data as sample from total 'n' rows of the data
sample <- sample.int(n = nrow(ramen_ratings_02), size = floor(.75*nrow(ramen_ratings_02)), replace = F)
train <- ramen_ratings_02[sample, ]
test  <- ramen_ratings_02[-sample, ]
glimpse(train)
dim(ramen_ratings_02)
dim(ramen_ratings_02)
dim(train)
dim(test)
set.seed(101) # Set Seed so that same sample can be reproduced in future also
sample <- sample.int(n = nrow(ramen_ratings_02), size = floor(.8*nrow(ramen_ratings_02)), replace = F)
train <- ramen_ratings_02[sample, ]
test  <- ramen_ratings_02[-sample, ]
dim(ramen_ratings_02)
dim(train)
dim(test)
tree = rpart(stars_target ~ country+brand+style, data=train,method = 'class')
rpart.plot(tree)
prp(tree)
#tree
predict_data<-predict(tree, test, type = 'class')
set.seed(101) # Set Seed so that same sample can be reproduced in future also
sample <- sample.int(n = nrow(ramen_ratings_02), size = floor(.8*nrow(ramen_ratings_02)), replace = F)
train <- ramen_ratings_02[sample, ]
test  <- ramen_ratings_02[-sample, ]
dim(ramen_ratings_02)
dim(train)
dim(test)
tree = rpart(stars_target ~ country+brand+style, data=train,method = 'class')
rpart.plot(tree)
prp(tree)
#tree
predict_data<-predict(tree, test, type = 'class')
set.seed(101) # Set Seed so that same sample can be reproduced in future also
sample <- sample.int(n = nrow(ramen_ratings_02), size = floor(.9*nrow(ramen_ratings_02)), replace = F)
train <- ramen_ratings_02[sample, ]
test  <- ramen_ratings_02[-sample, ]
dim(ramen_ratings_02)
dim(train)
dim(test)
tree = rpart(stars_target ~ country+brand+style, data=train,method = 'class')
rpart.plot(tree)
prp(tree)
#tree
predict_data<-predict(tree, test, type = 'class')
predict_data<-predict(tree, test%>%select(country,brand,style), type = 'class')
tree = rpart(stars_target ~ country+style, data=train,method = 'class')
rpart.plot(tree)
prp(tree)
#tree
predict_data<-predict(tree, test, type = 'class')
table_mat <- table(data_test$survived, predict_unseen)
predict_data<-predict(tree, test, type = 'class')
table_mat <- table(test$stars_target, predict_data)
table_mat
predict_data<-predict(tree, test, type = 'class')
predict_data
predict_data<-predict(tree, test, type = 'class')
predict_data
predict_data<-predict(tree, test, type = 'class')
table_mat <- table(test$stars_target, predict_data)
table_mat
predict_data<-predict(tree, test, type = 'class')
table_mat <- table(test$stars_target, predict_data)
table_mat
predict_data<-predict(tree, test, type = 'class')
table_mat <- table(test$stars_target, predict_data)
table_mat
test$predict_stars_target<-predict(tree, test, type = 'class')
table_mat <- table(test$stars_target, test$predict_stars_target)
table_mat
test$predict_stars_target<-predict(tree, test, type = 'class')
table_mat <- table(test$stars_target, test$predict_stars_target)
test$predict_stars_target<-predict(tree, test, type = 'class')
table_mat <- table(test$stars_target, test$predict_stars_target)
table_mat
test%>%mutate(true=if_else(stars_target==predict_stars_target,1,0))
test%>%mutate(true=if_else(stars_target==predict_stars_target,1,0))%>%group_by()%>%summarise(true=sum(true))
test%>%mutate(true=if_else(stars_target==predict_stars_target,1,0))%>%group_by()%>%summarise(true=sum(true),total=n())
test%>%mutate(true=if_else(stars_target==predict_stars_target,1,0))%>%group_by()%>%summarise(true=sum(true),total=n())%>%mutate(accuary_rate=true/total)
test$predict_stars_target<-predict(tree, test, type = 'class')
table_mat <- table(test$stars_target, test$predict_stars_target)
table_mat
test%>%count(stars_target)
test%>%count(stars_target)%>%mutate(percent = n / sum(n))
ramen_ratings_02=ramen_ratings%>%filter(is.na(stars)==FALSE)%>%
mutate(stars_level=factor(round(stars)),stars_target=factor(if_else(stars>=4,1,0)))%>%select(-review_number)%>%
mutate(brand_top=fct_lump(brand,20))
tree = rpart(stars_target ~ country+style+brand_top, data=train,method = 'class')
set.seed(101) # Set Seed so that same sample can be reproduced in future also
sample <- sample.int(n = nrow(ramen_ratings_02), size = floor(.9*nrow(ramen_ratings_02)), replace = F)
train <- ramen_ratings_02[sample, ]
test  <- ramen_ratings_02[-sample, ]
tree = rpart(stars_target ~ country+style+brand_top, data=train,method = 'class')
rpart.plot(tree)
prp(tree)
#tree
test$predict_stars_target<-predict(tree, test, type = 'class')
table_mat <- table(test$stars_target, test$predict_stars_target)
table_mat
test%>%mutate(true=if_else(stars_target==predict_stars_target,1,0))%>%group_by()%>%summarise(true=sum(true),total=n())%>%mutate(accuary_rate=true/total)
test%>%count(stars_target)%>%mutate(percent = n / sum(n))
ramen_ratings_02=ramen_ratings%>%filter(is.na(stars)==FALSE)%>%
mutate(stars_level=factor(round(stars)),stars_target=factor(if_else(stars>=4,1,0)))%>%select(-review_number)%>%
mutate(brand_top=fct_lump(brand,50))
set.seed(101) # Set Seed so that same sample can be reproduced in future also
sample <- sample.int(n = nrow(ramen_ratings_02), size = floor(.9*nrow(ramen_ratings_02)), replace = F)
train <- ramen_ratings_02[sample, ]
test  <- ramen_ratings_02[-sample, ]
dim(ramen_ratings_02)
dim(train)
dim(test)
tree = rpart(stars_target ~ country+style+brand_top, data=train,method = 'class')
rpart.plot(tree)
prp(tree)
#tree
test$predict_stars_target<-predict(tree, test, type = 'class')
table_mat <- table(test$stars_target, test$predict_stars_target)
table_mat
test%>%mutate(true=if_else(stars_target==predict_stars_target,1,0))%>%group_by()%>%summarise(true=sum(true),total=n())%>%mutate(accuary_rate=true/total)
test%>%count(stars_target)%>%mutate(percent = n / sum(n))
train$predict_stars_target<-predict(tree, train, type = 'class')
table_mat <- table(train$stars_target, train$predict_stars_target)
table_mat
train%>%mutate(true=if_else(stars_target==predict_stars_target,1,0))%>%group_by()%>%summarise(true=sum(true),total=n())%>%mutate(accuary_rate=true/total)
test%>%mutate(true=if_else(stars_target==predict_stars_target,1,0))%>%group_by()%>%summarise(true=sum(true),total=n())%>%mutate(accuary_rate=true/total)
test%>%mutate(true=if_else(stars_target==predict_stars_target,1,0))%>%group_by()%>%summarise(true=sum(true),total=n())%>%mutate(accuary_rate=true/total)
blogdown:::serve_site()
ramen_ratings_02%>%count(stars_target, sort = TRUE)%>%mutate(percent = n / sum(n))
# input data
library(readr)
# clean data
library(tidyverse)
# model
library(rpart)
library(rpart.plot)
ramen_ratings_02%>%count(stars_target, sort = TRUE)%>%mutate(percent = n / sum(n))
ramen_ratings_02=ramen_ratings%>%filter(is.na(stars)==FALSE)%>%
mutate(stars_level=factor(round(stars)),stars_target=factor(if_else(stars>=4,1,0)))%>%select(-review_number)%>%
mutate(brand_top=fct_lump(brand,50))
# input data
library(readr)
# clean data
library(tidyverse)
# model
library(rpart)
library(rpart.plot)
ramen_ratings <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-06-04/ramen_ratings.csv")
glimpse(ramen_ratings)
names(ramen_ratings%>%select_if(is.numeric))
names(ramen_ratings%>%select_if(is.character))
ramen_ratings %>%
keep(is.numeric) %>%
gather() %>%
ggplot(aes(value)) +
facet_wrap(~ key, scales = "free") +
geom_histogram()
ramen_ratings %>%mutate(brand=fct_lump(brand,10))%>%
count(brand, sort = TRUE)%>%mutate(percent = n / sum(n))
ramen_ratings %>%
count(style, sort = TRUE)%>%mutate(percent = n / sum(n))
ramen_ratings %>%mutate(country=fct_lump(country,8))%>%
count(country, sort = TRUE)%>%mutate(percent = n / sum(n))
ramen_ratings %>%mutate(country=fct_lump(country,20))%>%
count(brand,country, sort = TRUE)%>%mutate(percent = n / sum(n))
ramen_ratings%>%filter(country=='Hong Kong')
ramen_ratings%>%arrange(desc(stars))
ramen_ratings_02%>%count(stars_target, sort = TRUE)%>%mutate(percent = n / sum(n))
ramen_ratings_02=ramen_ratings%>%filter(is.na(stars)==FALSE)%>%
mutate(stars_level=factor(round(stars)),stars_target=factor(if_else(stars>=4,1,0)))%>%select(-review_number)%>%
mutate(brand_top=fct_lump(brand,50))
ramen_ratings_02%>%count(stars_target, sort = TRUE)%>%mutate(percent = n / sum(n))
View(ramen_ratings)
ramen_ratings_02=ramen_ratings%>%filter(is.na(stars)==FALSE)%>%
mutate(stars_level=factor(round(stars)),stars_target=factor(if_else(stars>=4,1,0)))%>%select(-review_number)%>%
mutate(brand_top=fct_lump(brand,50),
Spicy_flag=str_detect(variety,'Spicy')+str_detect(variety,'Chili')+str_detect(          variety,'Hot')+str_detect(variety,'Kimchi') ,
Beef_flag=str_detect(variety,'Beef'),
Udon_flag=str_detect(variety,'Udon'),
Chicken_flag=str_detect(variety,'Chicken'),
Laksa_flag=str_detect(variety,'Laksa')
)
ramen_ratings_02 %>%
count(stars_target, sort = TRUE)%>%mutate(percent = n / sum(n))
ramen_ratings_02 %>%
count(stars_level, sort = TRUE)%>%mutate(percent = n / sum(n))
set.seed(101) # Set Seed so that same sample can be reproduced in future also
sample <- sample.int(n = nrow(ramen_ratings_02), size = floor(.9*nrow(ramen_ratings_02)), replace = F)
train <- ramen_ratings_02[sample, ]
test  <- ramen_ratings_02[-sample, ]
dim(ramen_ratings_02)
dim(train)
dim(test)
dim(ramen_ratings_02)
dim(train)
dim(test)
glimpse(train)
set.seed(101) # Set Seed so that same sample can be reproduced in future also
sample <- sample.int(n = nrow(ramen_ratings_02), size = floor(.9*nrow(ramen_ratings_02)), replace = F)
train <- ramen_ratings_02[sample, ]%>%select(-variety,-stars,-stars_level,-brand)
test  <- ramen_ratings_02[-sample, ]%>%select(-variety,-stars,-stars_level,-brand)
dim(ramen_ratings_02)
dim(train)
dim(test)
glimpse(train)
tree = rpart(stars_target ~ country+style+brand_top, data=train,method = 'class')
rpart.plot(tree)
prp(tree)
#tree
train$predict_stars_target<-predict(tree, train, type = 'class')
table_mat <- table(train$stars_target, train$predict_stars_target)
table_mat
train%>%mutate(true=if_else(stars_target==predict_stars_target,1,0))%>%group_by()%>%summarise(true=sum(true),total=n())%>%mutate(accuary_rate=true/total)
tree = rpart(stars_target ~ ., data=train,method = 'class')
rpart.plot(tree)
prp(tree)
#tree
tree = rpart(stars_target ~ country+style+brand_top+Spicy_flag+Beef_flag+Udon_flag+Chicken_flag+Laksa_flag, data=train,method = 'class')
rpart.plot(tree)
prp(tree)
#tree
train$predict_stars_target<-predict(tree, train, type = 'class')
table_mat <- table(train$stars_target, train$predict_stars_target)
table_mat
train%>%mutate(true=if_else(stars_target==predict_stars_target,1,0))%>%group_by()%>%summarise(true=sum(true),total=n())%>%mutate(accuary_rate=true/total)
# input data
library(readr)
# clean data
library(tidyverse)
# model
library(rpart)
library(rpart.plot)
ramen_ratings <- readr::read_csv("https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2019/2019-06-04/ramen_ratings.csv")
glimpse(ramen_ratings)
names(ramen_ratings%>%select_if(is.numeric))
names(ramen_ratings%>%select_if(is.character))
ramen_ratings %>%
keep(is.numeric) %>%
gather() %>%
ggplot(aes(value)) +
facet_wrap(~ key, scales = "free") +
geom_histogram()
ramen_ratings %>%mutate(brand=fct_lump(brand,10))%>%
count(brand, sort = TRUE)%>%mutate(percent = n / sum(n))
ramen_ratings %>%
count(style, sort = TRUE)%>%mutate(percent = n / sum(n))
ramen_ratings %>%mutate(country=fct_lump(country,8))%>%
count(country, sort = TRUE)%>%mutate(percent = n / sum(n))
ramen_ratings %>%mutate(country=fct_lump(country,20))%>%
count(brand,country, sort = TRUE)%>%mutate(percent = n / sum(n))
ramen_ratings%>%filter(country=='Hong Kong')
ramen_ratings%>%arrange(desc(stars))
ramen_ratings_02=ramen_ratings%>%filter(is.na(stars)==FALSE)%>%
mutate(stars_level=factor(round(stars)),stars_target=factor(if_else(stars>=4,1,0)))%>%select(-review_number)%>%
mutate(brand_top=fct_lump(brand,50),
Spicy_flag=str_detect(variety,'Spicy')+str_detect(variety,'Chili')+str_detect(          variety,'Hot')+str_detect(variety,'Kimchi') ,
Beef_flag=str_detect(variety,'Beef'),
Udon_flag=str_detect(variety,'Udon'),
Chicken_flag=str_detect(variety,'Chicken'),
Laksa_flag=str_detect(variety,'Laksa')
)
ramen_ratings_02 %>%
count(stars_target, sort = TRUE)%>%mutate(percent = n / sum(n))
ramen_ratings_02 %>%
count(stars_level, sort = TRUE)%>%mutate(percent = n / sum(n))
data=ramen_ratings_02%>%mutate(country=fct_lump(country,8))
ggplot(data, aes(x = country, fill = stars_level))+
geom_bar(position="fill", colour="black")+
theme_classic(base_size = 9)+
labs(title='Bar chart for country due to stars ranges',
subtitle='Cumulated', y="Indicator", fill="User assessment ranges")
set.seed(101) # Set Seed so that same sample can be reproduced in future also
sample <- sample.int(n = nrow(ramen_ratings_02), size = floor(.9*nrow(ramen_ratings_02)), replace = F)
train <- ramen_ratings_02[sample, ]%>%select(-variety,-stars,-stars_level,-brand)
test  <- ramen_ratings_02[-sample, ]%>%select(-variety,-stars,-stars_level,-brand)
dim(ramen_ratings_02)
dim(train)
dim(test)
glimpse(train)
tree = rpart(stars_target ~ country+style+brand_top+Spicy_flag, data=train,method = 'class')
rpart.plot(tree)
prp(tree)
#tree
train$predict_stars_target<-predict(tree, train, type = 'class')
table_mat <- table(train$stars_target, train$predict_stars_target)
table_mat
train%>%mutate(true=if_else(stars_target==predict_stars_target,1,0))%>%group_by()%>%summarise(true=sum(true),total=n())%>%mutate(accuary_rate=true/total)
ramen_ratings_02=ramen_ratings%>%filter(is.na(stars)==FALSE)%>%
mutate(stars_level=factor(round(stars)),stars_target=factor(if_else(stars>=4,1,0)))%>%select(-review_number)%>%
mutate(brand_top=fct_lump(brand,50),
Spicy_flag=str_detect(variety,'Spicy')+str_detect(variety,'Chili')+str_detect(          variety,'Hot')+str_detect(variety,'Kimchi') +str_detect(variety,'Laksa'),
Beef_flag=str_detect(variety,'Beef'),
Udon_flag=str_detect(variety,'Udon'),
Chicken_flag=str_detect(variety,'Chicken')
)
set.seed(101) # Set Seed so that same sample can be reproduced in future also
sample <- sample.int(n = nrow(ramen_ratings_02), size = floor(.9*nrow(ramen_ratings_02)), replace = F)
train <- ramen_ratings_02[sample, ]%>%select(-variety,-stars,-stars_level,-brand)
test  <- ramen_ratings_02[-sample, ]%>%select(-variety,-stars,-stars_level,-brand)
dim(ramen_ratings_02)
dim(train)
dim(test)
glimpse(train)
tree = rpart(stars_target ~ country+style+brand_top+Spicy_flag, data=train,method = 'class')
rpart.plot(tree)
prp(tree)
#tree
train$predict_stars_target<-predict(tree, train, type = 'class')
table_mat <- table(train$stars_target, train$predict_stars_target)
table_mat
train%>%mutate(true=if_else(stars_target==predict_stars_target,1,0))%>%group_by()%>%summarise(true=sum(true),total=n())%>%mutate(accuary_rate=true/total)
data=ramen_ratings_02%>%
ggplot(data, aes(x = Spicy_flag , fill = stars_level))+
geom_bar(position="fill", colour="black")+
theme_classic(base_size = 9)+
labs(title='Bar chart for country due to stars ranges',
subtitle='Cumulated', y="Indicator", fill="User assessment ranges")
ramen_ratings_02=ramen_ratings%>%filter(is.na(stars)==FALSE)%>%
mutate(stars_level=factor(round(stars)),stars_target=factor(if_else(stars>=4,1,0)))%>%select(-review_number)%>%
mutate(brand_top=fct_lump(brand,50),
Spicy_flag=str_detect(variety,'Spicy')+str_detect(variety,'Chili')+str_detect(          variety,'Hot')+str_detect(variety,'Kimchi') +str_detect(variety,'Laksa'),
Beef_flag=str_detect(variety,'Beef'),
Udon_flag=str_detect(variety,'Udon'),
Chicken_flag=str_detect(variety,'Chicken')
)
data=ramen_ratings_02%>%
ggplot(data, aes(x = Spicy_flag , fill = stars_level))+
geom_bar(position="fill", colour="black")+
theme_classic(base_size = 9)+
labs(title='Bar chart for country due to stars ranges',
subtitle='Cumulated', y="Indicator", fill="User assessment ranges")
data=ramen_ratings_02%>%mutate(country=fct_lump(country,8))
ggplot(data, aes(x = country, fill = stars_level))+
geom_bar(position="fill", colour="black")+
theme_classic(base_size = 9)+
labs(title='Bar chart for country due to stars ranges',
subtitle='Cumulated', y="Indicator", fill="User assessment ranges")
data=ramen_ratings_02
ggplot(data, aes(x = Spicy_flag, fill = stars_level))+
geom_bar(position="fill", colour="black")+
theme_classic(base_size = 9)+
labs(title='Bar chart for country due to stars ranges',
subtitle='Cumulated', y="Indicator", fill="User assessment ranges")
data=ramen_ratings_02
ggplot(data, aes(x = Spicy_flag, fill = stars_level))+
geom_bar()+
theme_classic(base_size = 9)+
labs(title='Bar chart for country due to stars ranges',
subtitle='Cumulated', y="Indicator", fill="User assessment ranges")
ramen_ratings_02=ramen_ratings%>%filter(is.na(stars)==FALSE)%>%
mutate(stars_level=factor(round(stars)),stars_target=factor(if_else(stars>=4,1,0)))%>%select(-review_number)%>%
mutate(brand_top=fct_lump(brand,50),
Spicy=str_detect(variety,'Spicy')+str_detect(variety,'Chili')+str_detect(          variety,'Hot')+str_detect(variety,'Kimchi') +str_detect(variety,'Laksa'),
Spicy_flag=if_else(Spicy>0,1,0)
Beef_flag=str_detect(variety,'Beef'),
ramen_ratings_02=ramen_ratings%>%filter(is.na(stars)==FALSE)%>%
mutate(stars_level=factor(round(stars)),stars_target=factor(if_else(stars>=4,1,0)))%>%select(-review_number)%>%
mutate(brand_top=fct_lump(brand,50),
Spicy=str_detect(variety,'Spicy')+str_detect(variety,'Chili')+str_detect(          variety,'Hot')+str_detect(variety,'Kimchi') +str_detect(variety,'Laksa'),
Spicy_flag=if_else(Spicy>0,1,0),
Beef_flag=str_detect(variety,'Beef'),
Udon_flag=str_detect(variety,'Udon'),
Chicken_flag=str_detect(variety,'Chicken')
)
data=ramen_ratings_02
ggplot(data, aes(x = Spicy_flag, fill = stars_level))+
geom_bar()+
theme_classic(base_size = 9)+
labs(title='Bar chart for country due to stars ranges',
subtitle='Cumulated', y="Indicator", fill="User assessment ranges")
data=ramen_ratings_02
ggplot(data, aes(x = Spicy_flag, fill = stars_level))+
geom_bar(position="fill", colour="black")+
theme_classic(base_size = 9)+
labs(title='Bar chart for country due to stars ranges',
subtitle='Cumulated', y="Indicator", fill="User assessment ranges")
test$predict_stars_target_prob<-predict(tree, test)
test$predict_stars_target_prob
test$predict_stars_target_prob<-predict(tree, test)[2]
test$predict_stars_target_prob
test$predict_stars_target_prob<-predict(tree, test)
test$predict_stars_target_prob
test$predict_stars_target_prob<-predict(tree, test)[2]
test$predict_stars_target_prob
test$predict_stars_target_prob<-predict(tree, test)[1]
test$predict_stars_target_prob
test$predict_stars_target_prob<-predict(tree, test)[,1]
test$predict_stars_target_prob
test$predict_stars_target_prob<-predict(tree, test)[,2]
test$predict_stars_target_prob
test$predict_stars_target_prob<-predict(tree, test)[,2]
test=test%>%arrange(desc(predict_stars_target_prob))
test$predict_stars_target_prob<-predict(tree, test)[,2]
test=test%>%arrange(desc(predict_stars_target_prob))
test
test$predict_stars_target<-predict(tree, test, type = 'class')
table_mat <- table(test$stars_target, test$predict_stars_target)
table_mat
test%>%mutate(true=if_else(stars_target==predict_stars_target,1,0))%>%group_by()%>%summarise(true=sum(true),total=n())%>%mutate(accuary_rate=true/total)
test$predict_stars_target_prob<-predict(tree, test)[,2]
test=test%>%arrange(desc(predict_stars_target_prob))
test
test$predict_stars_target_prob<-predict(tree, test)[,2]
test=test%>%arrange(desc(predict_stars_target_prob))
top_50_test=head(test,50)
top_50_test%>%mutate(true=if_else(stars_target==predict_stars_target,1,0))%>%group_by()%>%summarise(true=sum(true),total=n())%>%mutate(accuary_rate=true/total)
# input data
library(readr)
# clean data
library(tidyverse)
# model
library(rpart)
library(rpart.plot)
library("ROCR")
# input data
library(readr)
# clean data
library(tidyverse)
# model
library(rpart)
library(rpart.plot)
library(ROCR)
pred <- prediction(predict(tree, type = "prob")[, 2], test$stars_target)
Pred.cart = predict(tree, newdata = test, type = "prob")[,2]
Pred2 = prediction(Pred.cart, test$stars_target)
plot(performance(Pred2, "tpr", "fpr"))
abline(0, 1, lty = 2)
blogdown:::serve_site()
